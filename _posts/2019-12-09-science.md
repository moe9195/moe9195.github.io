---
title: "Scientific Simulations Projects"
date: 2019-12-09
tags: [computational physics, simulations, computational science, scientific computing]
header:
  image: "/images/fractal.jpg"
excerpt: "Computational Physics, Simulations, Computational Science, Scientific Computing"
mathjax: "true"
---


## A collection of various computational science projects that I've previously worked on.

### [2-Dimensional Diffusion using Gray-Scott Model](https://nbviewer.jupyter.org/github/moe9195/Diffusion/blob/master/2D_diffusion.ipynb)

I perform a simulation of two chemicals (A and B) reacting and diffusing on a 2D grid using the Gray-Scott model.

Chemical A is added at a certain "feed" rate. Two Bs convert an A into a B (reaction). Chemical B is removed at a certain "kill" rate. The system can be approximated by using two numbers at each grid cell for the local concentrations of A and B. The concentration ranges from 0 to 1, under the restriction $0 \leq A+B \leq 1$. Both A and B diffuse so uneven concentrations spread out across the grid, however, A diffuses faster than B. When a large grid with many cells is simulated, complex patterns can emerge.
 
The grid is repeatedly updated to update the concentrations A and B of each cell using the following system of equations:

$$A' = A + (D_{A}\nabla^{2}A - AB^{2} + f(1-A))\Delta t$$
and
$$B' = B + (D_{b}\nabla^{2}B + AB^{2} - (k+f)B)\Delta t$$

where $A'$ and $B'$ are the new values for the concentrations, $A$ and $B$ are the previous values for the concentration, $D_{a}$ and $D_{b}$ are the diffusion rates for A and B, $f(1-A)$ is the feed rate scaled by $(1-A)$ so $A$ doesn't exceed 1.0.

$\Delta t$ is the time step for each iteration, $k$ is the kill rate which is scaled by $B$ so it doesn't go below 0 ($f$ is added to $k$ so the kill rate is never less than the feed rate).

The $AB^{2}$ terms account for the reaction rate, where the chance that 1 $A$ and 2 $B$ will come together is $A*B*B$. Since $A$ is converted to $B$ in the case of a reaction, this amount is subtracted from $A$ and added to $B$.

$\nabla^{2}A$ and $\nabla^{2}B$ are the Laplacians of A and B, which gives the difference between the average of nearby grid cells and the centre cell. This simulates diffusion as $A$ and $B$ become more like their neighbours. The Laplacian is performed with a convolution using the 3x3 kernel given by

$$\begin{bmatrix}
0.05 & 0.2 & 0.05\\ 
0.2 & -1 & 0.2\\ 
0.05 & 0.2 & 0.05
\end{bmatrix}$$

The grid is initialised with $A = 1$, $B = 0$ and a small area is seeded with $B = 1$.

Adjusting the two parameters for the feed rate and kill rate can produce a large range of results. We can visualise the grid by assigning each cell a colour based on its $A$ and $B$ values. For a large discussion on the parameter values and their respective patterns, see Robert Munafo's [detailed page](http://mrob.com/pub/comp/xmorphia/pearson-classes.html) on the subject.

 <img src="{{ site.url }}{{ site.baseurl }}/images/diff1.png" alt="2D Diffusion">
 <img src="{{ site.url }}{{ site.baseurl }}/images/diff2.png" alt="2D Diffusion">
 <img src="{{ site.url }}{{ site.baseurl }}/images/diff3.png" alt="2D Diffusion">
 
 ### [3-Dimensional Diffusion using Gray-Scott Model](https://nbviewer.jupyter.org/github/moe9195/Diffusion/blob/master/2D_diffusion.ipynb)
 
 The Gray-Scott model is implemented in 3 dimensions. This involves adding another dimension to the 2-D grid used in the 2 dimensional case. This extra dimension, however, adds difficulties in computation and visualisation. 

The mathematical model for the three dimensional case is the same as the two dimensional case, where the concentrations of A and B are updated following the system of equations:

$$A' = A + (D_{A}\nabla^{2}A - AB^{2} + f(1-A))\Delta t$$
and
$$B' = B + (D_{b}\nabla^{2}B + AB^{2} - (k+f)B)\Delta t$$

The diffusion operator $\nabla^2$ needs to be modified to three dimensions. This can be done using a 3D kernel. Here, we use an unbiased kernel with a centre value of -1 and surrounding values of 1/26. Other kernels can be used for different results.

The numpy arrays are then converted to VTK files for and visualised with [Paraview](https://www.paraview.org/).
 
 <iframe width="560" height="315" src="https://www.youtube.com/embed/w1hZURf2Y1Y" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>

